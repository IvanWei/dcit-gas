<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.5/build/pure-min.css" integrity="sha384-LTIDeidl25h2dPxrB2Ekgc9c7sEC3CWGM6HeFmuDNUjX76Ert4Z4IY714dhZHPLd" crossorigin="anonymous">
    <style>
      body {
        margin: 10px;
        background-image: url("https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=1920");
        background-position: center center;
        background-repeat: no-repeat;
        background-size: cover;
      }
      label {
        color: #fff;
      }
    </style>
    <script type="text/javascript">
      function submit() {
        const data = new FormData(document.querySelector('form'));
        var formData = {};
        data.forEach(function(value, key){formData[key] = value;});

        google.script.run.createEvent(formData);
        document.querySelector('form').reset();

        if (google.script.host.close) {
          google.script.host.close();
        }
      }
    </script>
  </head>
  <body>
    <form class="pure-form pure-form-stacked" onsubmit='submit();' id="form">
      <div><label>Activity Name<input name='title' placeholder='Activity Name' required /></label></div>
      <div><label>Flag<input name='flag' placeholder='使用「,」分隔' /></label></div>
      <fieldset>
        <label>
          Activity Date
          <div style='display: inline-flex;align-items: center;width: 100%;'>
            <input type='date' name='startDate' style='margin-right: 5px;' required />
            to
            <input type='date' name='endDate' style='margin-left: 5px;' required />
          </div>
        </label>
      </fieldset>
      <div><label>Location<input name='location' placeholder='location' /></label></div>
      <div style='margin: 20px 0;'>
        <label>Oversea</label>
        <label style='display: inline-block;'><input type="radio" name="oversea" value="TRUE">TRUE</label>
        <label style='display: inline-block;'><input type="radio" name="oversea" value="FALSE">FALSE</label>
      </div>
      <div><label>Main Webiste<input type=url name='source' placeholder='URL' /></label></div>
      <div><label>Sell Ticket<input type='url' name='ticketSource' placeholder='URL' /></label></div>
      <fieldset>
        <label>
          Ticket Date
          <div style='display: inline-flex;align-items: center;width: 100%;'>
            <input type='date' name='ticketStartTime' style='margin-right: 5px;' />
            to
            <input type='date' name='ticketEndTime' style='margin-left: 5px;' />
          </div>
        </label>
      </fieldset>
      <div><label>Call for Speaker<input type='url' name='callForSpeakerSource' placeholder='URL' /></label></div>
      <fieldset>
        <label>
          CFS Date
          <div style='display: inline-flex;align-items: center;width: 100%;'>
            <input type='date' name='callForSpeakerStartTime' style='margin-right: 5px;' />
            to
            <input type='date' name='callForSpeakerEndTime' style='margin-left: 5px;' />
          </div>
        </label>
      </fieldset>
    </form>

    <input class="pure-button" type="button" value="Close" onclick="google.script.host.close()" />
    <input class="pure-button" type="submit" value="Submit" form="form" />
  </body>
</html>
